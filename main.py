import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST =, 'https://www.facebook.com/100063778073022/', 'https://www.facebook.com/100063906224869/', 'https://www.facebook.com/100063927226471/', 'https://www.facebook.com/100063936436249/', 'https://www.facebook.com/100063992432631/', 'https://www.facebook.com/100064011066601/', 'https://www.facebook.com/100064086881025/', 'https://www.facebook.com/100064134515970/', 'https://www.facebook.com/100064193318222/', 'https://www.facebook.com/100064196673283/', 'https://www.facebook.com/100064306465104/', 'https://www.facebook.com/100064892594301/', 'https://www.facebook.com/100066550911906/', 'https://www.facebook.com/100066670989567/', 'https://www.facebook.com/100066702004119/', 'https://www.facebook.com/100067441095559/', 'https://www.facebook.com/100067683578348/', 'https://www.facebook.com/100068101999559/', 'https://www.facebook.com/100068247481716/', 'https://www.facebook.com/100069596026302/', 'https://www.facebook.com/100071424101982/', 'https://www.facebook.com/100072012491473/', 'https://www.facebook.com/100072099820552/', 'https://www.facebook.com/100075797397443/', 'https://www.facebook.com/100075801010729/', 'https://www.facebook.com/100075804433672/', 'https://www.facebook.com/100075955661486/', 'https://www.facebook.com/100076229040506/', 'https://www.facebook.com/100076351024607/', 'https://www.facebook.com/100076420057514/', 'https://www.facebook.com/100076521090908/', 'https://www.facebook.com/100076629837517/', 'https://www.facebook.com/100076679104361/', 'https://www.facebook.com/100076947680498/', 'https://www.facebook.com/100078469461786/', 'https://www.facebook.com/100078893493193/', 'https://www.facebook.com/100081206241930/', 'https://www.facebook.com/100081400132024/', 'https://www.facebook.com/100081748102650/', 'https://www.facebook.com/100082839906419/', 'https://www.facebook.com/100082942856035/', 'https://www.facebook.com/100083197785467/', 'https://www.facebook.com/100083526066452/', 'https://www.facebook.com/100083732721772/', 'https://www.facebook.com/100084068172617/', 'https://www.facebook.com/100084135602581/', 'https://www.facebook.com/100084876695723/', 'https://www.facebook.com/100084945527474/', 'https://www.facebook.com/100086058051344/', 'https://www.facebook.com/100086424204058/', 'https://www.facebook.com/100086475477778/', 'https://www.facebook.com/100086553169904/', 'https://www.facebook.com/100087008071037/', 'https://www.facebook.com/100087078383135/', 'https://www.facebook.com/100087382059945/', 'https://www.facebook.com/100087977359631/', 'https://www.facebook.com/100088524370838/', 'https://www.facebook.com/100088914336113/', 'https://www.facebook.com/100089328755266/', 'https://www.facebook.com/100089383045161/', 'https://www.facebook.com/100089387013781/', 'https://www.facebook.com/100089533764908/', 'https://www.facebook.com/100089662899838/', 'https://www.facebook.com/100089684124949/', 'https://www.facebook.com/100089808768623/', 'https://www.facebook.com/100090565595408/', 'https://www.facebook.com/100090583710876/', 'https://www.facebook.com/100090823905898/', 'https://www.facebook.com/100090824717617/', 'https://www.facebook.com/100091227547449/', 'https://www.facebook.com/100091470507250/', 'https://www.facebook.com/100091630646511/', 'https://www.facebook.com/100092337499105/', 'https://www.facebook.com/100092609786509/', 'https://www.facebook.com/100092618692352/', 'https://www.facebook.com/100092976603684/', 'https://www.facebook.com/100093363141779/', 'https://www.facebook.com/100093603677214/', 'https://www.facebook.com/100093801267945/', 'https://www.facebook.com/100094515589566/', 'https://www.facebook.com/100095193803446/', 'https://www.facebook.com/100095393800063/', 'https://www.facebook.com/100095581444648/', 'https://www.facebook.com/100095766752525/', 'https://www.facebook.com/102119482094834', 'https://www.facebook.com/102234545797935', 'https://www.facebook.com/103973678131899', 'https://www.facebook.com/1ClikProperty/', 'https://www.facebook.com/3karyaninfotech/', 'https://www.facebook.com/61550072126957/', 'https://www.facebook.com/61550092476738/', 'https://www.facebook.com/61550208173856/', 'https://www.facebook.com/61550354135326/', 'https://www.facebook.com/61550699369011/', 'https://www.facebook.com/61550787020475/', 'https://www.facebook.com/61551033197321/', 'https://www.facebook.com/61551054246670/', 'https://www.facebook.com/61551418466859/', 'https://www.facebook.com/61551774095660/', 'https://www.facebook.com/61551925211582/', 'https://www.facebook.com/61552005492430/', 'https://www.facebook.com/61552114703859/', 'https://www.facebook.com/61552347462529/', 'https://www.facebook.com/61552366954627/', 'https://www.facebook.com/61552418325841/', 'https://www.facebook.com/61552463360371/', 'https://www.facebook.com/61552471971866/', 'https://www.facebook.com/61552472792278/', 'https://www.facebook.com/61552481857357/', 'https://www.facebook.com/61552548617824/', 'https://www.facebook.com/61552930472386/', 'https://www.facebook.com/61552954154571/', 'https://www.facebook.com/61553025315793/', 'https://www.facebook.com/61553051859888/', 'https://www.facebook.com/61553063497610/', 'https://www.facebook.com/61553500532157/', 'https://www.facebook.com/61553579092902/', 'https://www.facebook.com/61553631122774/', 'https://www.facebook.com/61553653832875/', 'https://www.facebook.com/61553835778000/', 'https://www.facebook.com/61554143611543/', 'https://www.facebook.com/61554619182889/', 'https://www.facebook.com/61554832570796/', 'https://www.facebook.com/61555271070775/', 'https://www.facebook.com/61555321946082/', 'https://www.facebook.com/61555393290692/', 'https://www.facebook.com/61555548755852/', 'https://www.facebook.com/61555678276729/', 'https://www.facebook.com/61555756002328/', 'https://www.facebook.com/61555912614095/', 'https://www.facebook.com/61555934982357/', 'https://www.facebook.com/61556010467366/', 'https://www.facebook.com/61556175746363/', 'https://www.facebook.com/61556332174253/', 'https://www.facebook.com/61556388603996/', 'https://www.facebook.com/61556523816781/', 'https://www.facebook.com/61556534524109/', 'https://www.facebook.com/61556557385824/', 'https://www.facebook.com/61556680521686/', 'https://www.facebook.com/61556707104866/', 'https://www.facebook.com/61556891475640/', 'https://www.facebook.com/61556943592307/', 'https://www.facebook.com/61556959229469/', 'https://www.facebook.com/61556961338599/', 'https://www.facebook.com/61557027550881/', 'https://www.facebook.com/61557073127819/', 'https://www.facebook.com/61557109955908/', 'https://www.facebook.com/61557395887253/', 'https://www.facebook.com/61557402321973/', 'https://www.facebook.com/61557417972436/', 'https://www.facebook.com/61557465185443/', 'https://www.facebook.com/61557583680334/', 'https://www.facebook.com/61557723906230/', 'https://www.facebook.com/61557790028444/', 'https://www.facebook.com/61557821254852/', 'https://www.facebook.com/61557956730859/', 'https://www.facebook.com/61558175362690/', 'https://www.facebook.com/61558229585707/', 'https://www.facebook.com/61558464492875/', 'https://www.facebook.com/61558605326119/', 'https://www.facebook.com/61558619505501/', 'https://www.facebook.com/61558918717111/', 'https://www.facebook.com/61559083840074/', 'https://www.facebook.com/61559134782029/', 'https://www.facebook.com/61559148673607/', 'https://www.facebook.com/61559482452207/', 'https://www.facebook.com/61559591489169/', 'https://www.facebook.com/61559673942189/', 'https://www.facebook.com/61559781326559/', 'https://www.facebook.com/61559833956142/', 'https://www.facebook.com/61559842111441/', 'https://www.facebook.com/61559894813092/', 'https://www.facebook.com/61559926653281/', 'https://www.facebook.com/61559940249523/', 'https://www.facebook.com/61560083033278/', 'https://www.facebook.com/61560507296407/', 'https://www.facebook.com/61561155336244/', 'https://www.facebook.com/61561164546631/', 'https://www.facebook.com/61561533959779/', 'https://www.facebook.com/61561630770667/', 'https://www.facebook.com/61561634896991/', 'https://www.facebook.com/61561648207422/', 'https://www.facebook.com/61561915022332/', 'https://www.facebook.com/61562051577536/', 'https://www.facebook.com/61562288308404/', 'https://www.facebook.com/61562414122127/', 'https://www.facebook.com/61562432177183/', 'https://www.facebook.com/61562607382529/', 'https://www.facebook.com/61562700684714/', 'https://www.facebook.com/61562853452703/', 'https://www.facebook.com/61563053609158/', 'https://www.facebook.com/61563130916477/', 'https://www.facebook.com/61563285451391/', 'https://www.facebook.com/61563312153082/', 'https://www.facebook.com/61563487117368/', 'https://www.facebook.com/61563589591810/', 'https://www.facebook.com/61563605828293/', 'https://www.facebook.com/61563895197777/', 'https://www.facebook.com/61564038207510/', 'https://www.facebook.com/61564053046940/', 'https://www.facebook.com/61564405076547/', 'https://www.facebook.com/61564588487280/', 'https://www.facebook.com/61564625679009/', 'https://www.facebook.com/61564643657533/', 'https://www.facebook.com/61564817638576/', 'https://www.facebook.com/61564846061100/', 'https://www.facebook.com/61564953785583/', 'https://www.facebook.com/61564968117498/', 'https://www.facebook.com/61565105983271/', 'https://www.facebook.com/61565181642009/', 'https://www.facebook.com/61565293776824/', 'https://www.facebook.com/61565340734523/', 'https://www.facebook.com/61565349541440/', 'https://www.facebook.com/61565387956179/', 'https://www.facebook.com/61565408137582/', 'https://www.facebook.com/61565768133214/', 'https://www.facebook.com/61565871173510/', 'https://www.facebook.com/61565871180873/', 'https://www.facebook.com/61565893239803/', 'https://www.facebook.com/61565904660336/', 'https://www.facebook.com/61565942430573/', 'https://www.facebook.com/61566023112227/', 'https://www.facebook.com/61566070887674/', 'https://www.facebook.com/61566139979317/', 'https://www.facebook.com/61566247107275/', 'https://www.facebook.com/61566322902568/', 'https://www.facebook.com/61566353652216/', 'https://www.facebook.com/61566363901062/', 'https://www.facebook.com/61566505103788/', 'https://www.facebook.com/61566528233362/', 'https://www.facebook.com/61566562281622/', 'https://www.facebook.com/61566588050080/', 'https://www.facebook.com/61566604547703/', 'https://www.facebook.com/61566618883588/', 'https://www.facebook.com/61566822797706/', 'https://www.facebook.com/61566858809392/', 'https://www.facebook.com/61566935260664/', 'https://www.facebook.com/61566936135901/', 'https://www.facebook.com/61566939908947/', 'https://www.facebook.com/61566976620604/', 'https://www.facebook.com/61567008804220/', 'https://www.facebook.com/61567430723642/', 'https://www.facebook.com/61567515599369/', 'https://www.facebook.com/61567642660851/', 'https://www.facebook.com/61567775666818/', 'https://www.facebook.com/61567824003778/', 'https://www.facebook.com/61567832897824/', 'https://www.facebook.com/61567841620880/', 'https://www.facebook.com/61568142388351/', 'https://www.facebook.com/61568671468984/', 'https://www.facebook.com/61568804258470/', 'https://www.facebook.com/61568912300125/', 'https://www.facebook.com/61569158905362/', 'https://www.facebook.com/61569502645819/', 'https://www.facebook.com/61569516494431/', 'https://www.facebook.com/61569598409704/', 'https://www.facebook.com/61569635003356/', 'https://www.facebook.com/61569751403784/', 'https://www.facebook.com/61569947251591/', 'https://www.facebook.com/61569961321415/', 'https://www.facebook.com/61569968442179/', 'https://www.facebook.com/61569990246931/', 'https://www.facebook.com/61570089164565/', 'https://www.facebook.com/61570136349094/', 'https://www.facebook.com/61570163937936/', 'https://www.facebook.com/61570248745935/', 'https://www.facebook.com/61570331055056/', 'https://www.facebook.com/61570488327368/', 'https://www.facebook.com/61570606801885/', 'https://www.facebook.com/61570613178006/', 'https://www.facebook.com/61570835096074/', 'https://www.facebook.com/61570839082231/', 'https://www.facebook.com/61570843571448/', 'https://www.facebook.com/61570934185259/', 'https://www.facebook.com/61570994111784/', 'https://www.facebook.com/61571044809863/', 'https://www.facebook.com/61571200959990/', 'https://www.facebook.com/61571237662624/', 'https://www.facebook.com/61571424502465/', 'https://www.facebook.com/61571609139909/', 'https://www.facebook.com/61571623084987/', 'https://www.facebook.com/61571669381910/', 'https://www.facebook.com/61571794929438/', 'https://www.facebook.com/61571886644281/', 'https://www.facebook.com/61571975006996/', 'https://www.facebook.com/61572099909456/', 'https://www.facebook.com/61572110590987/', 'https://www.facebook.com/61572212117593/', 'https://www.facebook.com/61572382926732/', 'https://www.facebook.com/61572403721511/', 'https://www.facebook.com/61572445203385/', 'https://www.facebook.com/61572469168192/', 'https://www.facebook.com/61572487404521/', 'https://www.facebook.com/61572497473336/', 'https://www.facebook.com/61572507543917/', 'https://www.facebook.com/61572526685121/', 'https://www.facebook.com/61572590712726/', 'https://www.facebook.com/61572637134675/', 'https://www.facebook.com/61572660290840/', 'https://www.facebook.com/61572660808169/', 'https://www.facebook.com/61572682965931/', 'https://www.facebook.com/61572685393493/', 'https://www.facebook.com/61572704738122/', 'https://www.facebook.com/61572761237963/', 'https://www.facebook.com/61572776717084/', 'https://www.facebook.com/61572777190559/', 'https://www.facebook.com/61572788573519/', 'https://www.facebook.com/61572809981828/', 'https://www.facebook.com/61572810778710/', 'https://www.facebook.com/61572815073628/', 'https://www.facebook.com/61572833947777/', 'https://www.facebook.com/61572885204943/', 'https://www.facebook.com/61572914541008/', 'https://www.facebook.com/61572967455827/', 'https://www.facebook.com/61572987967747/', 'https://www.facebook.com/61572994004153/', 'https://www.facebook.com/61573009941535/', 'https://www.facebook.com/61573037772109/', 'https://www.facebook.com/61573057981692/', 'https://www.facebook.com/61573068015884/', 'https://www.facebook.com/61573093600862/', 'https://www.facebook.com/61573210923295/', 'https://www.facebook.com/61573266822555/', 'https://www.facebook.com/61573345000205/', 'https://www.facebook.com/61573432607411/', 'https://www.facebook.com/61573447150375/', 'https://www.facebook.com/61573455551811/', 'https://www.facebook.com/61573458149752/', 'https://www.facebook.com/61573480058790/', 'https://www.facebook.com/61573489857758/', 'https://www.facebook.com/61573515731976/', 'https://www.facebook.com/61573534019782/', 'https://www.facebook.com/61573564383079/', 'https://www.facebook.com/61573605160271/', 'https://www.facebook.com/61573612460299/', 'https://www.facebook.com/61573623523978/', 'https://www.facebook.com/61573695433359/', 'https://www.facebook.com/61573697493482/', 'https://www.facebook.com/61573698873277/', 'https://www.facebook.com/61573720484825/', 'https://www.facebook.com/61573742227376/', 'https://www.facebook.com/61573790480056/', 'https://www.facebook.com/61573815755660/', 'https://www.facebook.com/61573832266610/', 'https://www.facebook.com/61573856937358/', 'https://www.facebook.com/61573859859180/', 'https://www.facebook.com/61573860116628/', 'https://www.facebook.com/61573943335311/', 'https://www.facebook.com/61574046737005/', 'https://www.facebook.com/61574054265977/', 'https://www.facebook.com/61574062485905/', 'https://www.facebook.com/61574078167237/', 'https://www.facebook.com/61574091113971/', 'https://www.facebook.com/61574104694536/', 'https://www.facebook.com/61574110643561/', 'https://www.facebook.com/61574126410185/', 'https://www.facebook.com/61574140140593/', 'https://www.facebook.com/61574148790094/', 'https://www.facebook.com/61574163114834/', 'https://www.facebook.com/61574170618710/', 'https://www.facebook.com/61574181555787/', 'https://www.facebook.com/61574201408952/', 'https://www.facebook.com/61574209543791/', 'https://www.facebook.com/61574300473723/', 'https://www.facebook.com/61574445892271/', 'https://www.facebook.com/61574451429700/', 'https://www.facebook.com/61574452509588/', 'https://www.facebook.com/61574457657053/', 'https://www.facebook.com/61574459054182/', 'https://www.facebook.com/61574463133655/', 'https://www.facebook.com/61574480107104/', 'https://www.facebook.com/61574494753836/', 'https://www.facebook.com/61574496633795/', 'https://www.facebook.com/61574500494666/', 'https://www.facebook.com/61574513770708/', 'https://www.facebook.com/61574525379855/', 'https://www.facebook.com/61574539043328/', 'https://www.facebook.com/61574542430871/', 'https://www.facebook.com/61574542752833/', 'https://www.facebook.com/61574544221588/', 'https://www.facebook.com/61574571604774/', 'https://www.facebook.com/61574580311837/', 'https://www.facebook.com/61574584975834/', 'https://www.facebook.com/61574598907172/', 'https://www.facebook.com/61574599484813/', 'https://www.facebook.com/61574620886768/', 'https://www.facebook.com/61574635371897/', 'https://www.facebook.com/61574665876178/', 'https://www.facebook.com/61574668268483/', 'https://www.facebook.com/61574668966022/', 'https://www.facebook.com/61574687787687/', 'https://www.facebook.com/61574693595502/', 'https://www.facebook.com/61574718777633/', 'https://www.facebook.com/61574727190642/', 'https://www.facebook.com/61574738593108/', 'https://www.facebook.com/61574753143558/', 'https://www.facebook.com/61574753746080/', 'https://www.facebook.com/61574765245606/', 'https://www.facebook.com/61574790367364/', 'https://www.facebook.com/61574794094080/', 'https://www.facebook.com/61574807409069/', 'https://www.facebook.com/61574815892144/', 'https://www.facebook.com/61574816614765/', 'https://www.facebook.com/61574818477062/', 'https://www.facebook.com/61574831830742/', 'https://www.facebook.com/61574838807513/', 'https://www.facebook.com/61574841265815/', 'https://www.facebook.com/61574844831447/', 'https://www.facebook.com/61574858886036/', 'https://www.facebook.com/61574859010099/', 'https://www.facebook.com/61574893011328/', 'https://www.facebook.com/61574902265853/', 'https://www.facebook.com/61574968290738/', 'https://www.facebook.com/61574983563254/', 'https://www.facebook.com/61574994413135/', 'https://www.facebook.com/61575004614527/', 'https://www.facebook.com/61575039980664/', 'https://www.facebook.com/61575040621266/', 'https://www.facebook.com/61575048327985/', 'https://www.facebook.com/61575051628168/', 'https://www.facebook.com/61575085675806/', 'https://www.facebook.com/61575085859340/', 'https://www.facebook.com/61575092728118/', 'https://www.facebook.com/61575116814814/', 'https://www.facebook.com/61575123890441/', 'https://www.facebook.com/61575150353270/', 'https://www.facebook.com/61575151136024/', 'https://www.facebook.com/61575182782832/', 'https://www.facebook.com/61575188784311/', 'https://www.facebook.com/622946827565878', 'https://www.facebook.com/6262fitnessofficial/', 'https://www.facebook.com/7squareinteriordesign/', 'https://www.facebook.com/AARADHYA-COLLEGE-OF-EDUCATION-PVTLTD-608591652318900/', 'https://www.facebook.com/AKASH-CLASSES-169232622943973/', 'https://www.facebook.com/ARCANE-STUDIO-PVT-LTD-159190100600412/', 'https://www.facebook.com/ATHENASIAConsulting/', 'https://www.facebook.com/AVM-Arch-Lab-387822821082818/', 'https://www.facebook.com/AVsdesign04/', 'https://www.facebook.com/Airspace.ind/', 'https://www.facebook.com/AlphaInstituteOfEventManagement/', 'https://www.facebook.com/Anchoransh/', 'https://www.facebook.com/AndrewAdam.Photography/', 'https://www.facebook.com/Aniirudhkundra/', 'https://www.facebook.com/AnkurRajTiwariOfficial/', 'https://www.facebook.com/AnselmoAcademy/', 'https://www.facebook.com/AnuraMakeupArtistry/', 'https://www.facebook.com/AouraaProduction/', 'https://www.facebook.com/Arbitration-514601038405550/', 'https://www.facebook.com/AryonWedding']


phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
